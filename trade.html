<!DOCTYPE html>
<html>
<head>
<title>NovaTrade Trading</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="card">
<h2>Trading Simulation</h2>
<p>Fixed Capital: $500</p>
<button onclick="toggleTheme()">Toggle Theme</button>
</div>

<div class="card">
<h3>Total Balance:</h3>
<h2 id="balance">$500.00</h2>

<select id="pair">
<option>BTC/USDT</option>
<option>ETH/USDT</option>
<option>SOL/USDT</option>
<option>ADA/USDT</option>
<option>XRP/USDT</option>
<option>DOGE/USDT</option>
<option>DOT/USDT</option>
<option>LTC/USDT</option>
<option>AVAX/USDT</option>
<option>TRX/USDT</option>
</select>

<button onclick="startStopTrade()">Start / Stop Trade</button>
<button onclick="holdContinue()">Hold / Continue</button>
</div>

<!-- ------------------------ -->
<!-- Animated Signal + Chart -->
<!-- ------------------------ -->
<div class="card signal">
  <div class="signal-top">
    <div>
      <h2 id="signalText">Signal: BUY</h2>
      <small id="signalDesc">Trend confirmed â€¢ Strong momentum</small>
    </div>
    <div class="price">
      <div class="p" id="signalPrice">50000</div>
      <div class="chg up" id="signalChange">+0.00%</div>
    </div>
  </div>
</div>

<div class="card chartWrap">
  <canvas id="chart"></canvas>
</div>

<div class="card">
<h3>Deposit (Simulation)</h3>
<input type="number" id="depositAmount" placeholder="Enter amount">
<button onclick="simulateDeposit()">Confirm Deposit</button>
<p id="depositMsg"></p>
</div>

<div class="card">
<h3>Withdrawal (Simulation)</h3>
<input type="number" id="withdrawAmount" placeholder="Enter amount">
<button onclick="unlockWithdrawal()">Unlock Withdrawal</button>
<p id="withdrawMsg"></p>
</div>

<div class="card">
<h3>Transaction History</h3>
<ul id="history"></ul>
</div>

<div class="nav">
<button onclick="location.href='withdrawal.html'">Withdrawal Page</button>
<button onclick="location.href='home.html'">Dashboard</button>
</div>

<script src="script.js"></script>

<script>
document.getElementById("balance").innerText =
 "$" + (parseFloat(localStorage.getItem("balance")) || 500).toFixed(2);

function simulateDeposit(){
 let amount = parseFloat(depositAmount.value);
 if(!amount || amount <= 0) return;

 depositMsg.innerText = "Processing deposit... (1 min simulation)";

 setTimeout(()=>{
   let bal = parseFloat(localStorage.getItem("balance")) || 500;
   bal += amount;
   localStorage.setItem("balance", bal);
   depositMsg.innerText = "Deposit Successful!";
   saveHistory("Deposit +" + amount);
   location.reload();
 }, 60000);
}

function unlockWithdrawal(){
 let amount = parseFloat(withdrawAmount.value);
 let bal = parseFloat(localStorage.getItem("balance")) || 500;

 if(amount < 1 || bal - amount < 500){
   withdrawMsg.innerText = "Cannot withdraw below $500 base capital.";
   return;
 }

 withdrawMsg.innerText = "Unlocking withdrawal... (1 min)";
 setTimeout(()=>{
   bal -= amount;
   localStorage.setItem("balance", bal);
   withdrawMsg.innerText = "Withdrawal Successful!";
   saveHistory("Withdrawal -" + amount);
   location.reload();
 }, 60000);
}

function saveHistory(text){
 let list = JSON.parse(localStorage.getItem("history")) || [];
 list.push(text + " | " + new Date().toLocaleTimeString());
 localStorage.setItem("history", JSON.stringify(list));
}

function loadHistory(){
 let list = JSON.parse(localStorage.getItem("history")) || [];
 list.forEach(item=>{
   history.innerHTML += `<li>${item}</li>`;
 });
}
loadHistory();

/* ------------------------ */
/* Signal + Animated Chart */
/* ------------------------ */
const canvas = document.getElementById("chart");
const ctx = canvas.getContext("2d");
canvas.width = canvas.offsetWidth;
canvas.height = 320;

let data = [];
const MAX_POINTS = 50;
let price = 50000; // starting price

function generateNextPrice() {
  const change = (Math.random() - 0.5) * 100; // small random fluctuation
  price = Math.max(100, price + change);
  data.push(price);
  if(data.length > MAX_POINTS) data.shift();
}

function drawChart() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.beginPath();
  ctx.strokeStyle = "#f0b90b";
  ctx.lineWidth = 2;
  const minPrice = Math.min(...data);
  const maxPrice = Math.max(...data);
  for(let i=0;i<data.length;i++){
    const x = (canvas.width/MAX_POINTS)*i;
    const y = canvas.height - ((data[i]-minPrice)/(maxPrice-minPrice||1) * canvas.height);
    if(i===0) ctx.moveTo(x,y);
    else ctx.lineTo(x,y);
  }
  ctx.stroke();
}

function updateSignal() {
  if(data.length < 2) return;
  const change = data[data.length-1] - data[data.length-2];
  const signalText = document.getElementById("signalText");
  const signalChange = document.getElementById("signalChange");
  const signalPrice = document.getElementById("signalPrice");

  signalPrice.textContent = Math.round(price);

  if(change > 0){
    signalText.textContent = "Signal: BUY";
    signalChange.textContent = "+" + change.toFixed(2);
    signalChange.className = "chg up";
  } else {
    signalText.textContent = "Signal: SELL";
    signalChange.textContent = change.toFixed(2);
    signalChange.className = "chg down";
  }
}

function animate() {
  generateNextPrice();
  drawChart();
  updateSignal();
  requestAnimationFrame(()=>setTimeout(animate, 500)); // slow animation
}

animate();
</script>

<style>
/* ------------------------ */
/* Signal + Animated Chart Styles */
.signal{
  margin:14px 0;
  background:#101722;
  border:1px solid rgba(255,255,255,.06);
  border-radius:16px;
  padding:14px;
  box-shadow:0 10px 40px rgba(0,0,0,.35);
}
.signal-top{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:10px;
}
.signal h2{
  font-size:15px;
  margin-bottom:4px;
}
.signal small{
  color:#9aa4b2;
  font-size:12px;
}
.price{
  text-align:right;
}
.price .p{
  font-size:18px;
  font-weight:800;
}
.price .chg{
  font-size:12px;
  font-weight:700;
  margin-top:3px;
}
.chg.up{color:#00c087;}
.chg.down{color:#f6465d;}

.chartWrap{
  margin:14px 0;
  background:#0f141b;
  border:1px solid rgba(255,255,255,.06);
  border-radius:18px;
  overflow:hidden;
  box-shadow:0 10px 40px rgba(0,0,0,.35);
}
canvas{
  width:100%;
  height:320px;
  display:block;
}
</style>

</body>
</html>
